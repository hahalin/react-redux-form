
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Validation Â· React Redux Form</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        
        <!-- Meta -->
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.0">
        
        

        <!-- Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/fonts/fontawesome-webfont.woff">

        <!-- Styles -->
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="tracking.html" />
    
    
    <link rel="prev" href="models.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="README.md">
            
                <span>
            
                    
                    Guides
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="quickstart.html">
            
                <a href="quickstart.html">
            
                    
                    Quick Start
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="models.html">
            
                <a href="models.html">
            
                    
                    Models
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.3" data-path="validation.html">
            
                <a href="validation.html">
            
                    
                    Validation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="tracking.html">
            
                <a href="tracking.html">
            
                    
                    Tracking Collections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="custom-controls.html">
            
                <a href="custom-controls.html">
            
                    
                    Custom Controls
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="compare-redux-form.html">
            
                <a href="compare-redux-form.html">
            
                    
                    Compare to Redux-Form
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../api/README.md">
            
                <span>
            
                    
                    API Reference
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../api/Control.html">
            
                <a href="../api/Control.html">
            
                    
                    Control component
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../api/Field.html">
            
                <a href="../api/Field.html">
            
                    
                    Field component
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../api/modelReducer.html">
            
                <a href="../api/modelReducer.html">
            
                    
                    modelReducer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../api/formReducer.html">
            
                <a href="../api/formReducer.html">
            
                    
                    formReducer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../api/combineForms.html">
            
                <a href="../api/combineForms.html">
            
                    
                    combineForms
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../api/actions.html">
            
                <a href="../api/actions.html">
            
                    
                    action creators
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../recipes/README.md">
            
                <span>
            
                    
                    Recipes and Examples
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../recipes/quickstart.html">
            
                <a href="../recipes/quickstart.html">
            
                    
                    Quick Start
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <a href="../.." >Validation</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="validation">Validation</h1><p>Validation occurs as the result of dispatching validation actions, such as <code>actions.setValidity(model, validity)</code> or <code>actions.setErrors(model, errors)</code>. That action updates the form validity and error state of your model, and allows you to:</p><ul><li>validate any part of the model state (however deep),
</li>
<li>validate any key on that model (such as <code>{ required: true, length: false }</code>)
</li>
<li>call validation only when the model has been updated.
</li></ul>
<h2 id="simple-validation">Simple Validation</h2><p>Suppose you are validating <code>&apos;user.email&apos;</code>. At any point, you can dispatch <code>actions.setValidity()</code> to set the validity of that model on your form state:</p><pre><code class="lang-js">import { actions } from &apos;react-redux-form&apos;;

function emailIsValid(email) {
  // terrible validation, I know
  return email &amp;&amp; email.length &gt; 0;
}

// in the connected component&apos;s render() method...
const { dispatch, user } = this.props;

return
&lt;input type=&quot;text&quot;
  onChange={(e) =&gt; dispatch(actions.change(&apos;user.email&apos;, e))}
  onBlur={() =&gt; dispatch(actions.validate(&apos;user.email&apos;, emailIsValid))}
/&gt;</code></pre>
<h2 id="multiple-validation-keys">Multiple Validation Keys</h2><p>You can also get more specific with validation by returning an object with validation keys. The API is the same -- this time, we&apos;ll use the excellent <a href="https://www.npmjs.com/package/validator" target="_blank">validator</a> library to help us.</p><p><strong>Note:</strong> React Redux Form can work with any validator function library!</p><pre><code class="lang-js">import { actions } from &apos;react-redux-form&apos;;
import validator from &apos;validator&apos;;

// wherever validation is occurring:
dispatch(actions.validate(&apos;user.email&apos;, {
  required: (value) =&gt; value &amp;&amp; value.length,
  valid: validator.isEmail
});</code></pre>
<h2 id="updated-form-state">Updated Form State</h2><p>Here&apos;s what happens when you set the validity of a model, via <code>dispatch(actions.setValidity(model, validity))</code>:</p><ul><li><p>The <code>.errors</code> property of the model&apos;s field is set:</p><ul><li>if <code>validity</code> is boolean, <code>.errors = !validity</code>. If valid, <code>.errors = false</code>, and vice-versa
</li>
<li>if <code>validity</code> is an object, <code>.errors</code> is set to the opposite of each validation key (see example below)
</li></ul>
</li>
<li><p>The <code>.validity</code> property of the model&apos;s field is set as the inverse of <code>.errors</code></p></li>
<li><p>The <code>.valid</code> property of the model&apos;s field is set:</p><ul><li><code>.valid = true</code> if the validity is truthy or if each validation key value is truthy
</li>
<li><code>.valid = false</code> if the validity is falsey or if any validation key is falsey
</li></ul>
</li>
<li><p>The <code>.valid</code> property of all parent forms of the model are set:</p><ul><li><code>.valid = true</code> if every field in the form is valid
</li>
<li><code>.valid = false</code> if any field in the form is invalid
</li></ul>
</li></ul>
<p>Here&apos;s an example:</p><pre><code class="lang-js">import { actions } from &apos;react-redux-form&apos;;

// wherever validation occurs...
const { userForm, dispatch } = this.props;

dispatch(actions.setValidity(&apos;user.email&apos;, {
  required: true,
  isEmail: false
}); // user entered email but email is invalid

userForm.email.valid;
// =&gt; false

userForm.email.errors;
// =&gt; { required: false, isEmail: true }

userForm.$form.valid;
// =&gt; false</code></pre>
<h2 id="async-validity">Async Validity</h2><p>There are multiple ways you can handle setting validity asynchronously. As long as a validation action such as <code>setValidity()</code> or <code>setErrors()</code> is dispatched, the validity will be updated. It&apos;s generally a good idea to dispatch <code>setPending(model, pending)</code> to indicate that the model is currently being validated.</p><p>Here&apos;s a solution using an action thunk creator (with <code>redux-thunk</code>):</p><pre><code class="lang-js">// username-actions.js
import { actions } from &apos;react-redux-form&apos;;

export function checkAvailability(username) {
  return (dispatch) =&gt; {
    dispatch(actions.setPending(&apos;user.username&apos;, true));

    // some asynchronous validation function that returns a promise
    asyncCheckUsername(username)
      .then((response) =&gt; {
         dispatch(actions.setValidity(&apos;user.username&apos;, {
           available: response.available
         });

         dispatch(actions.setPending(&apos;user.username&apos;, false));
      });
  }
}</code></pre>
<p>Alternatively, the <code>asyncSetValidity(model, validator)</code> action thunk creator does the above by using the <code>done</code> callback as the second argument to <code>validator(value, done)</code>:</p><pre><code class="lang-js">import { actions } from &apos;react-redux-form&apos;;

// wherever validation occurs...
const { user, dispatch } = this.props;

dispatch(actions.setAsyncValidity(&apos;user.username&apos;, (value, done) =&gt; {
  asyncCheckUsername(value)
    .then((response) =&gt; done({ available: response.available });
}));</code></pre>
<p>If you are working with <strong>promises</strong>, the <code>submit(model, promise)</code> action will automatically set the <code>.errors</code> of the <code>model</code> field if the promise is rejected:</p><pre><code class="lang-js">import { actions } from &apos;react-redux-form&apos;;

// your custom promise
import checkUsernamePromise from &apos;../path/to/promise&apos;;

// wherever dispatch() is available...
dispatch(actions.submit(&apos;user&apos;, checkUsernamePromise));</code></pre>
<p>If the promise you are working with can reject with errors for each individual field, such as:</p><pre><code>{
  &quot;email&quot;: [&quot;The email address is invalid.&quot;],
  &quot;firstName&quot;: [&quot;Name contains illegal characters.&quot;]
}</code></pre>
<p>then you can use <code>actions.submitFields(&apos;user&apos;, myPromise)</code>, which will set errors for each individual field (e.g., <code>&quot;user.email&quot;</code>, <code>&quot;user.firstName&quot;</code>), instead of just the <code>&quot;user&quot;</code> model.</p><h2 id="validation-with-field-and-control-components">Validation with <code>&lt;Field&gt;</code> and <code>&lt;Control&gt;</code> components</h2><p>The <code>&lt;Field&gt;</code> and <code>&lt;Control&gt;</code> components accept a few validation-specific props:</p><ul><li><p><code>validators</code> - an object with key-value pairs:</p><ul><li><strong>validation key</strong> (string) and
</li>
<li><strong>validator</strong> (function) - a function that takes in the model <code>value</code> and returns a boolean (true/false if valid/invalid)
</li></ul>
</li>
<li><p><code>asyncValidators</code> - an object with key-value pairs:</p><ul><li><strong>validation key</strong> (string) and
</li>
<li><strong>validator</strong> (function) - a function that takes in the model <code>value</code> and the <code>done</code> callback, similar to <code>asyncSetValidity(value, done)</code>
</li></ul>
</li>
<li><p><code>validateOn</code> and <code>asyncValidateOn</code> - event to indicate when to validate:</p><ul><li><code>&quot;change&quot;</code> (default for <code>validators</code>)
</li>
<li><code>&quot;blur&quot;</code> (default for <code>asyncValidators</code>)
</li>
<li><code>&quot;focus&quot;</code>
</li>
<li>or multiple values, such as <code>[&quot;change&quot;, &quot;blur&quot;]</code>
</li></ul>
</li></ul>
<p>Here&apos;s an example with the above email and username fields:</p><pre><code class="lang-js">import { Control } from &apos;react-redux-form&apos;;
import { isEmail } from &apos;../path/to/validators&apos;;

// in the component&apos;s render() method:
&lt;Field
  model=&quot;user.email&quot;
  validators={{
    required: (val) =&gt; val &amp;&amp; val.length,
    isEmail,
  }}
  validateOn=&quot;blur&quot;
&gt;
  &lt;input type=&quot;email&quot; /&gt;
&lt;/Field&gt;

&lt;Control.text
  model=&quot;user.firstName&quot;
  validators={{
    required: (val) =&gt; val &amp;&amp; val.length,
  }}
  validateOn=&quot;change&quot;
/&gt;

&lt;Field model=&quot;user.username&quot;
  validators={{
    required: (val) =&gt; val &amp;&amp; val.length
  }}
  asyncValidators={{
    available: (val, done) =&gt; asyncCheckUsername(val)
      .then(res =&gt; done(res.available))
  }}
  asyncValidateOn=&quot;blur&quot;
&gt;
  &lt;input type=&quot;text&quot; /&gt;
&lt;/Field&gt;</code></pre>
<h2 id="html5-validation">HTML5 Validation</h2><p><a href="http://www.html5rocks.com/en/tutorials/forms/constraintvalidation/" target="_blank">HTML Constraint Validation</a> is recognized in RRF, and RRF will detect if the control&apos;s DOM node <code>.willValidate</code>. If so, then whenever validation occurs on the control, RRF will set the corresponding validation fields automatically.</p><p>This means that validation such as the examples below will <em>just work</em>:</p><pre><code class="lang-js">import { Field, Control } from &apos;react-redux-form&apos;;

// ...

&lt;Field model=&quot;user.email&quot;&gt;
  &lt;input type=&quot;email&quot; /&gt;
&lt;/Field&gt;

&lt;Control.text
  model=&quot;user.firstName&quot;
  required
/&gt;</code></pre>
<p>If you want to disable HTML5 validation for a form, add a <code>novalidate</code> attribute to the form element:</p><pre><code class="lang-js">import { Form } from &apos;react-redux-form&apos;;

// email input will not be validated
&lt;Form model=&quot;user&quot; novalidate&gt;
  &lt;Control.email /&gt;
&lt;/Form&gt;</code></pre>
<h2 id="custom-error-messages">Custom Error Messages</h2><p>Similar to how the <code>validators</code> prop and <code>setValidity()</code> action works, you can use the <code>errors</code> prop and <code>setErrors()</code> action to indicate errors. Keep in mind, these should express the <em>inverse</em> validity state of the model. This means that anything <em>truthy</em> indicates an error.</p><p><strong>Disclaimer:</strong> I do <em>not</em> recommend hard-coding error messages in your validators. Messages are view concerns, and a simple boolean <code>true</code> or <code>false</code> is more than enough to indicate the validity of a model. When in doubt, use <code>validators</code> and/or <code>setValidity</code>.</p><p>Here&apos;s how the <code>setErrors()</code> action works:</p><pre><code class="lang-js">import { actions } from &apos;react-redux-form&apos;;
import validator from &apos;validator&apos;;

// wherever dispatch() is available:
dispatch(actions.setErrors(&apos;user.email&apos;, {
  invalid: (val) =&gt; !validator.isEmail(val) &amp;&amp; &apos;Not a valid email&apos;,
  length: (val) =&gt; val &lt; 8 &amp;&amp; &apos;Email is too short&apos;
}));</code></pre>
<p>If a form reducer exists for <code>&apos;user&apos;</code>, this will set various properties of the <code>userForm.fields.email</code> state:</p><pre><code class="lang-js">// Assuming a long but invalid email:

userForm.email.valid;
// =&gt; false

userForm.email.errors;
// =&gt; { invalid: &apos;Not a valid email&apos;, length: false }

userForm.email.validity;
// =&gt; { invalid: false, length: true }</code></pre>
<p>Error validators can be defined in the <code>errors</code> prop of the <code>&lt;Form&gt;</code>, <code>&lt;Field&gt;</code>, and <code>&lt;Control&gt;</code> components, as well:</p><pre><code class="lang-js">import { Control } from &apos;react-redux-form&apos;;
import { isEmail } from &apos;../path/to/validators&apos;;

// in the component&apos;s render() method:
&lt;Field
  model=&quot;user.email&quot;
  errors={{
    required: (val) =&gt; !val || !val.length,
    isEmail: (val) =&gt; !isEmail(val),
  }}
  validateOn=&quot;blur&quot;
&gt;
  &lt;input type=&quot;email&quot; /&gt;
&lt;/Field&gt;

&lt;Control.text
  model=&quot;user.firstName&quot;
  errors={{
    required: (val) =&gt; !val || !val.length,
  }}
  validateOn=&quot;change&quot;
/&gt;</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="models.html" class="navigation navigation-prev " aria-label="Previous page: Models">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="tracking.html" class="navigation navigation-next " aria-label="Next page: Tracking Collections">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Validation","level":"1.2.3","depth":2,"next":{"title":"Tracking Collections","level":"1.2.4","depth":2,"path":"docs/guides/tracking.md","ref":"docs/guides/tracking.md","articles":[]},"previous":{"title":"Models","level":"1.2.2","depth":2,"path":"docs/guides/models.md","ref":"docs/guides/models.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-highlight","-sharing","-fontsettings","github","livereload","theme-rrf"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"github":{"url":"https://github.com/davidkpiano/react-redux-form"},"prism":{"css":["prismjs/themes/prism-okaidia.css"]},"livereload":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"theme-rrf":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"React Redux Form","gitbook":"3.x.x"},"file":{"path":"docs/guides/validation.md","mtime":"2016-09-14T05:16:49.000Z","type":"markdown"},"gitbook":{"version":"3.2.0","time":"2016-09-16T23:18:44.859Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    

    </body>
</html>

